[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Therapy Session",
  "enabled": 1,
  "modified": "2024-06-25 12:29:10.505487",
  "module": "Swissmedhealth",
  "name": "Merge Invoice",
  "script": "frappe.listview_settings['Therapy Session'] = {\n    onload: function(listview) {\n        listview.page.add_inner_button(__('Merge Invoice'), function() {\n            const selected_docs = listview.get_checked_items();\n\n            if (selected_docs.length === 0) {\n                frappe.msgprint(__('Please select at least one Therapy Session'));\n                return;\n            }\n\n            const therapy_sessions = selected_docs.map(doc => doc.name);\n            console.log(\"::::::::::::therapy_sessions:::\",therapy_sessions)\n\n            frappe.call({\n                method: \"swissmedhealth.swissmedhealth.hooks.custom_therapy_session.merge_therapy_sessions_to_invoice\",\n                args: {\n                    'therapy_sessions': therapy_sessions\n                },\n                callback: function(r) {\n                    if(r.message) {\n                        console.log(\"::::::::::::::::::::\",r.message)\n                        frappe.msgprint(__('Invoice Created: ' + r.message));\n                        listview.refresh();\n                    }\n                }\n            });\n        });\n    }\n};\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Therapy Plan",
  "enabled": 1,
  "modified": "2024-06-14 14:53:27.694573",
  "module": "Swissmedhealth",
  "name": "Custom Buttion Therapy Plan",
  "script": "frappe.ui.form.on('Therapy Plan', {\n\trefresh: function(frm,cdt,cdn) {\n\t    frm.page.remove_inner_button(__('Therapy Session'),  __('Create'));\n\t\tfrm.add_custom_button(__(\"Treatment Appointment\"), function() {\t    \t\t\n\t\t\tfrappe.new_doc(\"Therapy Session\", {\n\t\t\t    \"therapy_plan\": frm.doc.name,\n\t\t\t\t\"patient\": frm.doc.patient,\n\t\t\t});\n\t\t}, __(\"Create\"));\n\t}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Therapy Session",
  "enabled": 1,
  "modified": "2024-06-26 12:24:02.098710",
  "module": "Swissmedhealth",
  "name": "Calendar View",
  "script": "frappe.views.calendar[\"Therapy Session\"] = {\n\tfield_map: {\n\t\t\"status\": \"Draft\",\n        \"id\": \"name\",\n        \"title\": \"patient\",\n        \"start\": \"start\",\n        \"end\": \"end\",  // Make sure you have an end_date if needed\n        // \"allDay\": \"all_day\", // Optional, if you are using all-day events\n        \"therapy_plan\": \"therapy_plan\",\n        \"eventColor\": \"color\"\n\t},\n\torder_by: \"start_date\",\n\tgantt: true,\n\tget_events_method: \"swissmedhealth.public.therapy_session.get_events\"\n};\n",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Therapy Session",
  "enabled": 1,
  "modified": "2024-06-26 08:26:56.196649",
  "module": "Swissmedhealth",
  "name": "Script room and chair multi select",
  "script": "frappe.ui.form.on('Therapy Session', {\n    // refresh: function(frm) {\n    //     frm.add_fetch('therapy_type', 'room_number', 'room_number');\n    // },\n    therapy_type: function(frm) {\n        console.log(\"test :::::::::::::::::::::::::::::::::::\");\n        if(frm.doc.therapy_type) {\n            // Fetch room numbers based on selected therapy types\n            frappe.call({\n                method: 'swissmedhealth.public.therapy_session.get_room_numbers_by_therapy_types',\n                args: {\n                    therapy_type_ids: frm.doc.therapy_type\n                },\n                callback: function(r) {\n                    if(r.message) {\n                        let room_numbers = r.message;\n                        frm.clear_table(\"custom_room_number_1\");  // Assuming \"room_numbers\" is the table field\n                        \n                        room_numbers.forEach(function(room) {\n                            console.log(\"room ::::::::::::::::\", room);\n                            let new_row = frm.add_child(\"custom_room_number_1\");\n                            new_row.name1 = room;\n                        });\n                        \n                        refresh_field(\"custom_room_number_1\");\n                    }\n                }\n            });\n        }\n    }\n});\n\n\nfrappe.ui.form.on('Therapy Session', {\n    therapy_type: function(frm) {\n        console.log(\"test :::::::::::::::::::::::::::::::::::\");\n        if(frm.doc.therapy_type) {\n            // Fetch room numbers based on selected therapy types\n            frappe.call({\n                method: 'swissmedhealth.public.therapy_session.get_total_chair_by_therapy_types',\n                args: {\n                    therapy_type_ids: frm.doc.therapy_type\n                },\n                callback: function(r) {\n                    if(r.message) {\n                        let chair_numbers = r.message;\n                        frm.clear_table(\"custom_total_chairs\");  // Assuming \"room_numbers\" is the table field\n                        \n                        chair_numbers.forEach(function(chair) {\n                            console.log(\"chair ::::::::::::::::\", chair);\n                            let new_row = frm.add_child(\"custom_total_chairs\");\n                            new_row.name1 = chair;\n                        });\n                        \n                        refresh_field(\"custom_total_chairs\");\n                    }\n                }\n            });\n        }\n    }\n});\n\nfrappe.ui.form.on('Therapy Session', {\n    therapy_type: function(frm) {\n        console.log(\"test :::::::::::::::::::::::::::::::::::\");\n        if(frm.doc.therapy_type) {\n            // Fetch room numbers based on selected therapy types\n            frappe.call({\n                method: 'swissmedhealth.public.therapy_session.get_total_beds_by_therapy_types',\n                args: {\n                    therapy_type_ids: frm.doc.therapy_type\n                },\n                callback: function(r) {\n                    if(r.message) {\n                        let bed_numbers = r.message;\n                        frm.clear_table(\"custom_total_beds\");  // Assuming \"room_numbers\" is the table field\n                        \n                        bed_numbers.forEach(function(bed) {\n                            console.log(\"bed ::::::::::::::::\", bed);\n                            let new_row = frm.add_child(\"custom_total_beds\");\n                            new_row.totals_beds = bed;\n                        });\n                        \n                        refresh_field(\"custom_total_beds\");\n                    }\n                }\n            });\n        }\n    }\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Therapy Session",
  "enabled": 1,
  "modified": "2024-06-26 09:06:22.636791",
  "module": "Swissmedhealth",
  "name": "Fetch Healthcare Practitioner in therapy session from therapy plan",
  "script": "frappe.ui.form.on('Therapy Session', {\n\ttherapy_type: function(frm) {\n\t\tif (frm.doc.therapy_type) {\n\t\t\tfrappe.call({\n\t\t\t\t'method': 'frappe.client.get',\n\t\t\t\targs: {\n\t\t\t\t\tdoctype: 'Therapy Type',\n\t\t\t\t\tname: frm.doc.therapy_type\n\t\t\t\t},\n\t\t\t\tcallback: function(data) {\n\t\t\t\t\tfrm.set_value('practitioner', data.message.custom_healthcare_practitioner);\n\t\t\t\t}\n\t\t\t});\n\t\t} \n\t\telse {\n\t\t\tfrm.refresh_field(\"codification_table\");\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Quotation",
  "enabled": 1,
  "modified": "2024-06-27 07:17:16.026565",
  "module": "Swissmedhealth",
  "name": "Button Quotaion form - Create Therapy Plan",
  "script": "frappe.ui.form.on('Quotation', {\n    refresh: function(frm) {\n        if (!frm.doc.__islocal && frm.doc.docstatus === 1) {\n            frm.add_custom_button(__('Create Therapy Plan'), function() {\n                create_therapy_plan(frm);\n            }, __('Create')); // Adding under 'Actions' instead of 'Create'\n        }\n    }\n});\n\nfunction create_therapy_plan(frm) {\n    frappe.call({\n        method: 'swissmedhealth.swissmedhealth.hooks.quotation.create_therapy_plan',\n        args: {\n            quotation_name: frm.doc.name\n        },\n        callback: function(r) {\n            if (!r.exc) {\n                frappe.msgprint(__('Therapy Plan created successfully'));\n                frappe.set_route('Form', 'Therapy Plan', r.message);\n            }\n        }\n    });\n}\n",
  "view": "Form"
 }
]